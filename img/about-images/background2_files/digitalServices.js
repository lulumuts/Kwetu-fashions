(function(b){if(b.DigitalServices){logDebug("Digitalservices - already loaded");return}DigitalServices={services:{},env:{}};DigitalServices.gs=function(c){if(DigitalServices.services[c]){if(b[c]){b[c].refresh(DigitalServices.env)}else{b[c]=new DigitalServices.services[c](DigitalServices.env)}}else{logDebug("DigitalService - Load service {"+c+"}");var a=CONFIGURATION.jsPath+"DS_"+c+".js";this.getCachedScript(a,function(d,e){logDebug("DigitalService - Service {"+c+"} loaded");b[c]=new DigitalServices.services[c](DigitalServices.env)})}return b[c]};DigitalServices.getCachedScript=function(d,c){var a=$.extend(a||{},{dataType:"script",cache:true,url:d,data:{storeLang:DigitalServices.env.lang}});return jQuery.ajax(a).done(c)};DigitalServices.initEnv=function(a){logDebug("Digitalservices - initEnv");this.env=a};DigitalServices.initAnimEnv=function(c,f){DigitalServices.env.animationId=c;var e="";if(f=="standalone"||f=="autonome"){e="json"}else{e="clean.json"}var d=DigitalServices.env.animationResourcePath+DigitalServices.env.animationId+"/i18n/"+DigitalServices.env.lang+"/data/localized."+e;var a=DigitalServices.env.animationResourcePath+DigitalServices.env.animationId+"/data/global.json";jQuery.ajax({type:"GET",dataType:"json",url:d,success:function(g){DigitalServices.env.animationLocalized=JSON.stringify(g);logDebug("localized configuration loaded")},error:function(g,i,h){logDebug("fail:\n"+i+"\n"+h+"\n")},data:{storeLang:DigitalServices.env.lang}});jQuery.ajax({type:"GET",dataType:"json",url:a,success:function(g){DigitalServices.env.animationGlobal=JSON.stringify(g);logDebug("global configuration loaded")},error:function(g,i,h){logDebug("fail:\n"+i+"\n"+h+"\n")},data:{storeLang:DigitalServices.env.lang}})};DigitalServices.getId=function(a){return"#"+a};(function(){var a=false,d=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(c){var i=this.prototype;a=true;var j=new this();a=false;for(var k in c){j[k]=typeof c[k]=="function"&&typeof i[k]=="function"&&d.test(c[k])?(function(f,e){return function(){var g=this._super;this._super=i[f];var h=e.apply(this,arguments);this._super=g;return h}})(k,c[k]):c[k]}function l(){if(!a&&this.init){this.init.apply(this,arguments)}}l.prototype=j;l.prototype.constructor=l;l.extend=arguments.callee;return l}})();DigitalServices.services.BaseService=Class.extend({cfg:{idService:"Base",version:"1_0",method:"POST"},init:function(e){var d=Object.keys(e);for(var c=0;c<d.length;c++){var a=d[c];this.cfg[a]=e[a]}},refresh:function(a){return this.init(a)},getAjax:function(i,c,k,j){logDebug("Entering getAjax()");logDebug("  Service called: ["+DigitalServices.env.lang+"]["+this.cfg.version+"]"+this.cfg.idService+"."+c);var f;if(i){f=DigitalServices.env.secureDomainName}else{f=DigitalServices.env.domainName}var h=f+DigitalServices.env.serviceLocation+"/"+(this.cfg.idService).toLowerCase()+"/"+this.cfg.version+"/"+this.cfg.idService+"Service/"+c;logDebug("    Url: "+h);var l;if(i){l={async:true,success:j,xhrFields:{withCredentials:true}}}else{l={async:false,success:j}}var d;var g;var a=AJAX_CACHE_MAP[c];var c=this.cfg.method;l.contentType="application/json; charset=utf-8";l.method=c;if(c=="GET"){d=h+"?storeLang="+DigitalServices.env.lang+"&serviceRequest="+encodeURIComponent(JSON.stringify(k));if(a!=null){d+="&cache="+a}l.url=d}else{d=h+"?storeLang="+DigitalServices.env.lang;if(a!=null){d+="&cache="+a}g=JSON.stringify(k);l.data=g;l.url=d}if(DigitalServices.env.animationId!=null){l.headers={"call-ctx":"ANIMATION:"+DigitalServices.env.animationId}}logDebug("    ajaxQuery: "+JSON.stringify(l));if(!$.support.cors&&i){var e=CONFIGURATION.XDR_CALLBACKS.push(j);setTimeout(function(){document.getElementById(getIframeId(i)).contentWindow.postMessage(JSON.stringify({url:d,id:e-1,data:g,contentType:"application/json; charset=utf-8",type:c}),"*")},50)}else{return jQuery.ajax(l).responseText}},getJSONEntries:function(e,d){logDebug("Entering getJSONEntries()");logDebug("  Service called: ["+DigitalServices.env.lang+"]["+this.cfg.version+"]"+this.cfg.idService);var c;if(d){c=DigitalServices.env.animationResourcePath+DigitalServices.env.animationId+"/i18n/"+DigitalServices.env.lang+"/data/"+e+".json"}else{c=DigitalServices.env.animationResourcePath+DigitalServices.env.animationId+"/data/"+e+".json"}var a;return jQuery.ajax({type:"GET",url:c,async:true,xhrFields:{withCredentials:true},data:{storeLang:DigitalServices.env.lang}}).responseText}})})(window);DigitalServices.services.UI=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> UI : Init");this.cfg.idService="UIService"},validatePageCompatibility:function(){registerEvent("getDeviceTypeEvent",DigitalServices.gs("UIService")._internalvalidatePageCompatibility())},_internalvalidatePageCompatibility:function(){var a=DigitalServices.env.pageCompatibility;var c=localStorage.deviceType;if(!this.checkPageCompatibility(a.currentPage,c)){for(var b=0;b<a.fallbacks.length;b++){var d=a.fallbacks[b];if(this.checkPageCompatibility(d,c)){window.location.href=this.reconstructUrl(d.pageId);return}}}},reconstructUrl:function(d){var a=this.getParamValue("chunkUrl",window.location.href);var b=window.location.href;var c=b.replace(a,d);return c},getParamValue:function(d,b){var a=b==undefined?document.location.href:b;var c=new RegExp("(\\?|&|^)"+d+"=(.*?)(&|$)");matches=a.match(c);return(matches&&matches[2]!=undefined)?decodeURIComponent(matches[2]).replace(/\+/g," "):""},checkPageCompatibility:function(c,a){var d=c.compatibilityRule.split(",");for(var b=0;b<d.length;b++){if(d[b]==a){return true}}return false},turnOrientationCurtainOn:function(){showCurtain("OrientationAnimation")},turnOrientationCurtainOff:function(){hideCurtain("OrientationAnimation")}});DigitalServices.services.Catalog=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> Catalog : Init");this.cfg.idService="Catalog"},findProduct:function(b,c){var a=this.getAjax(false,"findProduct",{productId:b,chapters:(c==null)?[]:c});return a},findProducts:function(a,c){var b=this.getAjax(false,"findProducts",{productIds:a,chapters:(c==null)?[]:c});return b},findSku:function(a,c){var b=this.getAjax(false,"findSku",{skuId:a,chapters:(c==null)?[]:c});return b},findMultipleSku:function(b,c){var a=this.getAjax(false,"findMultipleSku",{skuIds:b,chapters:(c==null)?[]:c});return a},findSkuLiveData:function(a){var b=this.getAjax(false,"findSkuLiveData",{skuId:a});return b}});DigitalServices.services.Cart=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> Cart : Init");this.cfg.idService="Cart"},addToCart:function(a,c,d){var b=this.getAjax(false,"addToCart",{skuId:a,quantity:c},d);return b}});DigitalServices.services.Wishlist=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> Wishlist : Init");this.cfg.idService="Wishlist"},addToWishlist:function(a,c){var b=this.getAjax(false,"addToWishlist",{skuId:a},c);return b}});DigitalServices.services.Share=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> Share : Init");this.cfg.idService="Share"},shareAnimationByMail:function(b,f,e,d,g,c){var a=this.getAjax(false,"shareAnimationByMail",{type:"ANIMATION",values:b,nameDestination:f,emailDestination:e,nameSender:d,emailSender:g,message:c});return a},shareAnimationMailTo:function(b,e,d,c,f){var a=this.getAjax(false,"shareAnimationMailTo",{values:b,nameDestination:e,emailDestination:d,nameSender:c,emailSender:f});return a},shareAnimation:function(c,b){networkName=b;var a=this.getAjax(false,"shareAnimation",{animationId:c},handleShareAnimation)}});DigitalServices.services.Environment=DigitalServices.services.BaseService.extend({init:function(){logDebug(">> Environment : Init");this.cfg.idService="Environment"},getEnvironment:function(){return DigitalServices.env},getDeepLinkKey:function(){return location.href.substring(location.href.lastIndexOf("#")+1)},createDeepLinkAnchor:function(a){return"#"+a},gotoDeepLink:function(a){location.href(location.href+this.createDeepLinkAnchor(a))},getLocalConfig:function(){var a=DigitalServices.env.animationLocalized;return a},getGlobalConfig:function(){var a=DigitalServices.env.animationGlobal;return a}});DigitalServices.getShareService=function(a){if(a=="zhs_CN"||a=="zhs-cn"){return{weibo:true}}else{return{facebook:true,twitter:true,pinterest:true}}};